<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Projects</title>
    <meta name="description" content="Clotho Projects">
    <meta name="viewport" content="width=1024, initial-scale=1">
    <script src ="clotho3API/clotho3API.js"></script>
    <script src ="clotho3API/papaparse.min.js"></script>

    <!-- not necessary until serving outside root directory / want html5 mode -->
    <base href="/">

    <link rel="stylesheet" href="styles/2e84f2a0.command.css"/>
    <link rel="stylesheet" href="styles/773cbfe6.main.css"/>
    <link rel ="stylesheet" href="styles/Phagebook_Styles.css"/>

    <script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/q.js/1.0.0/q.js"></script>
    <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>

    <script src="bower_components/jquery/jquery.js"></script>

    <!-- note that angular is required for any clotho functionality -->
    <script src="bower_components/angular/angular.js"></script>
    <!-- note that lodash is required by several components -->
    <script src="bower_components/lodash/dist/lodash.js"></script>
    <script src="projectsCTRL.js"></script>
    <script src="projects-app.js"></script>

</head>
<body onload="displaycontainers()">
<script src="bower_components/es5-shim/es5-shim.js"></script>
<script src="bower_components/json3/lib/json3.min.js"></script>

<div ng-app="clothoRoot">
    <div class="container">
        <div clotho-command-bar></div>
    </div>
    <terminal-aside></terminal-aside>
</div>

<div class = "contentBackground" >
    <div class = "mainContent">
        <!--div class = "leftColumn">-->
        <!--<img src = "/images/people/Katie_Lewis.jpeg">-->
        <!--<h4> <a href ="./Profile.html">Katie Lewis</a> Projects </h4>-->
        <!--<table id="projTable">-->
            <!--&lt;!&ndash;<tr>&ndash;&gt;-->
            <!--&lt;!&ndash;<td id="iGEM"><a href="./Projects.html" value="igem.id" style="display:block;">iGEM</a> </td>&ndash;&gt;-->
            <!--&lt;!&ndash;</tr>&ndash;&gt;-->
            <!--&lt;!&ndash;<tr>&ndash;&gt;-->
            <!--&lt;!&ndash;<td id="Phagebook"><a href = "./Projects.html" style = "display:block;">Phagebook</a></td>&ndash;&gt;-->
            <!--&lt;!&ndash;</tr>&ndash;&gt;-->
        <!--</table>-->

        <!--<br><br>-->

        <!--<button type="button" id="CreateButton">Create New Project </button>-->

    <!--</div>-->
        <div class = "leftColumn">
            <img src = "/images/people/Katie_Lewis.jpeg">
            <h4> <a href ="./Profile.html">Katie Lewis</a> Projects </h4>
            <table id="projTable">
                <!--<tr>-->
                <!--<td id="iGEM"><a href="./Projects.html" value="igem.id" style="display:block;">iGEM</a> </td>-->
                <!--</tr>-->
                <!--<tr>-->
                <!--<td id="Phagebook"><a href = "./Projects.html" style = "display:block;">Phagebook</a></td>-->
                <!--</tr>-->
            </table>

            <br><br>
        </div>

    <div id = "rightColumn">
        <h1 class = "pageHeading"> Create New Container </h1><br><br> 
        <!--Add filters to look through containers related to person/project/lab-->
        <div id="createBox">
            <ng-form class="form-horizontal" name="boxForm" ng-class="{'has-error' : boxForm.name.$dirty && boxForm.name.$invalid}">
                <select name="containerType" id="containerTypes" onchange = "displayOptions()">
                    <option value="culture">Culture</option>
                    <option value="tube">Tube</option>
                    <option value="wellPlate">Plate</option>
                    <option value="box">Box</option>
                    <option value="fridge">Fridge</option>
                </select><br><br>
                <label>Container Label: </label><br> 
                <input placeholder="IG-2-3" id="containerName" type="text"><br><br>
                <div id="parentContainerEnable">
                <label>Parent Container: </label><br>
                <div class="units">
                    <input type="text" id="parentContainer" placeholder="Container ID">
                    <select name="containerType" id="parentContainerTypes" onchange = "typeOfContainer()">
                        <option value="fridge">Fridge</option>
                        <option value="box">Box</option>
                    </select><br><br>
                </div>
                <label id="coordinateLabel">Coordinates: </label>
                     <div id="xyCoordinates">
                     <input type="number" id = "xcoordinate" placeholder = "X Coordinate">
                     <input type="number" id="ycoordinate" placeholder = "Y Coordinate"><br><br>
                     </div>
                <div id="shelfCoordinate">
                    <input type="number" placeholder="3 (Shelf Number)"><br><br>
                </div>
                    </div>
                <div id="fridge">
                    <label>Number of Shelves: </label><br>
                    <input type="number" id="shelfNum"><br><br>
                    <label>Temperature: </label><br>
                    <div class="units">
                    <input type="number" id="fridgeTemp"> <input type="text" id="tempUnit" class="unitInput" placeholder="F"> <br><br>
                    </div>
                </div>
                <div id="box">
                    <label>Number of Rows: </label><br>
                    <input type="number" id="rows"><br><br>
                    <label>Number of Columns: </label><br>
                    <input type="number" id="columns"><br><br>
                </div>
                <div id="wellPlate">
                    <label>Well Volume: </label><br>
                    <div class="units">
                    <input type="number" id="wellVolume"> <input type="text" class="unitInput" placeholder = "mL"><br><br>
                    </div>
                </div>
                <div id="tubes">
                    <label>Volume: </label><br>
                    <div class="units">
                    <input type="number" id="tubeVolume"> <input type="text" class="unitInput" id="tubeVolumeUnit" placeholder="mL"><br><br>
                    </div>
                </div>
                <!--Also have text input? e.g. shelf 3-->
                <!--<label># of rows: </label><br>-->
                <!--<input id="boxRows" type="number"><br><br>-->
                <!--<label># of columns: </label><br>-->
                <!--<input id="boxColumns" type="number"><br><br>-->

                <button id = "boxSubmit" class="btn btn-primary" >Create</button><br>


            </ng-form>
        </div>
        <br>
        <br>
        <div id="wrapper"></div>
        <button id="changingBox" onclick="changeCell()">Save</button>
    </div>
        <p id = "hiddenParagraph"></p>
    </div>
        <!--<div>-->
            <!--<p>Assign parts to inventory</p>-->
        <!--</div>-->
</div>

<!--Scripts-->

<script src="scripts/b18fc8c8.clotho-app-command.js"></script>

<script src="scripts/c0f113c2.clotho-core-module.js"></script>

<!--<script src ="scripts/notebook_projects.js"></script>-->

<!--note - remove all scripts below this for api-only build-->

<script src="scripts/c2a11f43.clotho-foundation-module.js"></script>


<script src="scripts/68a2b2df.clotho-command-module.js"></script>

<script>
function displayOptions(){
    if (document.getElementById("containerTypes").value == "fridge"){
        document.getElementById("fridge").style.display = "block";
        document.getElementById("box").style.display = "none";
        document.getElementById("wellPlate").style.display = "none";
        document.getElementById("tubes").style.display = "none";
        document.getElementById("parentContainerEnable").style.display="none";
    }
    else if (document.getElementById("containerTypes").value == "box"){
        document.getElementById("box").style.display = "block";
        document.getElementById("fridge").style.display = "none";
        document.getElementById("wellPlate").style.display = "none";
        document.getElementById("tubes").style.display = "none";
        document.getElementById("parentContainerEnable").style.display="block";

    }
    else if (document.getElementById("containerTypes").value == "tube"){
        document.getElementById("box").style.display = "none";
        document.getElementById("fridge").style.display = "none";
        document.getElementById("wellPlate").style.display = "none";
        document.getElementById("tubes").style.display = "block";
        document.getElementById("parentContainerEnable").style.display="block";

    }
    else if (document.getElementById("containerTypes").value == "wellPlate"){
        document.getElementById("box").style.display = "block";
        document.getElementById("fridge").style.display = "none";
        document.getElementById("wellPlate").style.display = "block";
        document.getElementById("tubes").style.display = "none";
        document.getElementById("parentContainerEnable").style.display="block";
    }
    else{
        document.getElementById("box").style.display = "none";
        document.getElementById("fridge").style.display = "none";
        document.getElementById("wellPlate").style.display = "none";
        document.getElementById("tubes").style.display = "none";
        document.getElementById("parentContainerEnable").style.display="block";

    }
}
</script>

<script>
    function typeOfContainer() {
            if(document.getElementById("parentContainerTypes").value == "fridge"){
                document.getElementById("shelfCoordinate").style.display = "block";
                document.getElementById("xyCoordinates").style.display = "none";
                document.getElementById("coordinateLabel").style.display ="block";
            }
        else{
                if(document.getElementById("containerTypes").value=="tube"){
                    document.getElementById("shelfCoordinate").style.display = "none";
                    document.getElementById("xyCoordinates").style.display = "block";
                    document.getElementById("coordinateLabel").style.display ="block";
                }
                else{
                    document.getElementById("shelfCoordinate").style.display = "none";
                    document.getElementById("xyCoordinates").style.display = "none";
                    document.getElementById("coordinateLabel").style.display ="none";
                }
            }
    }
</script>
<script>
    $(document).ready(function() {
        $("#boxSubmit").click(function () {
            switch(document.getElementById("containerTypes").value){
                case "box":
//                        create object for coordinates, volume, columns, rows, temp,
                        var colVariable = {"schema":"org.clothocad.model.variable","name":"columns"};
                        Clotho.create(colVariable).then(function(res){
                            var columnParam = {"value":document.getElementById("columns").value,"variable":res};
                            var rowVariable = {"schema":"org.clothocad.model.variable","name":"rows"};
                            Clotho.create(rowVariable).then(function(rowRes){
                                var rowParam = {"value":document.getElementById("rows").value,"variable":rowRes};
//                                var coordParam = {"value":document.getElementById("coordinates").value,"variable":"containerCoordinates"};
//                                Clotho.create(coordParam).then(function(result){
                                    Clotho.create(columnParam).then(function(colParam){
                                        Clotho.create(rowParam).then(function(rowParameter){
                                            var obj = {"schema":"org.clothocad.model.container","name":document.getElementById("containerName").value,"type":document.getElementById("containerTypes").value,"parentContainer":document.getElementById("parentContainer").value,"columns":colParam, "rows":rowParameter};
                                            Clotho.create(obj);
                                        });
                                    });
                                });
                            });
                    break;
                case "fridge":
                   var tempVariable = {"schema":"org.clothocad.model.variable","name":"temperature"};
                    Clotho.create(tempVariable).then(function(res){
                        var unitVariable = {"name":document.getElementById("tempUnit").value};
                        Clotho.create(unitVariable).then(function(resultUnit){
                            var tempParam = {"value":document.getElementById("fridgeTemp").value,"variable":res,"units":resultUnit};
                            Clotho.create(tempParam).then(function(result){
                                var shelfVar = {"schema":"org.clothocad.model.variable","name":"numberofShelves"};
                                Clotho.create(shelfVar).then(function(shelfVar){
                                    var shelfParam = {"value":document.getElementById("shelfNum").value,"variable":shelfVar};
                                    Clotho.create(shelfParam).then(function(shelfPar){
                                        var obj = {"schema":"org.clothocad.model.container","name":document.getElementById("containerName").value,"temperature":result,"shelves":shelfPar,"type":document.getElementById("containerTypes").value,"parentContainer":document.getElementById("parentContainer").value};
                                        alert(obj);
                                        Clotho.create(obj);
                                    });
                                });
                            });
                        });

                    });
                    break;
                case "tube":
                    var volumeVariable = {"schema":"org.clothocad.model.variable","name":"volume"};
                    Clotho.create(volumeVariable).then(function(res){
                        var unitVar = {"name":document.getElementById("tubeVolumeUnit").value};
                        Clotho.create(unitVar).then(function(result){
                           var volumeParam = {"value":document.getElementById("tubeVolume").value,"variable":res,"units":result};
                            alert(volumeParam);
                            var obj={"schema":"org.clothocad.model.container","name":document.getElementById("containerName").value,"type":document.getElementById("containerTypes").value,"volume":volumeParam,"parentContainer":document.getElementById("parentContainer").value};
                            alert(obj);
                            Clotho.create(obj);
                        });
                    });
                    break;
                case "plate":
                    var rowParam = {"value":document.getElementById("rows").value,"variable":"554ce65e30044fb2131de752"};
                    var columnParam = {"value":document.getElementById("columns").value,"variable":"554ce65e30044fb2131de750"};
                    Clotho.create(rowParam).then(function(res){
                        Clotho.create(columnParam).then(function(result){
                            var obj = {"schema":"org.clothocad.model.container","name":document.getElementById("containerName").value,"type":document.getElementById("containerTypes").value,"rows":res,"columns":result,"parentContainer":document.getElementById("parentContainer").value};
                            Clotho.create(obj)
                        });
                    });
                    break;
                case "culture":
                    var obj = {"schema":"org.clothocad.model.container","name":document.getElementById("containerName").value,"type":document.getElementById("containerTypes").value,"parentContainer":document.getElementById("parentContainer").value};
                    Clotho.create(obj);
            }
        });
    });
</script>

<!--<script>-->
    <!--$(document).ready(function() {-->
        <!--$("#boxSubmit").click(function () {-->
            <!--var personID = "clotho.developer.katielewis";-->
            <!--var num_rows = document.getElementById("boxRows").value;-->
            <!--var num_cols = document.getElementById("boxColumns").value;-->
            <!--var name = document.getElementById("boxName").value;-->
            <!--var tbody = '';-->
            <!--var theader = '<div contenteditable="true"><h2 id="headerID"></h2><table id= "newBox" border="1" width="300" cellpadding="30" onclick="editBox(this)">\n';-->
            <!--for ($u=1; $u<=num_rows;$u++){-->
                <!--tbody += '<tr>';-->
                    <!--for(var j=0;j<num_cols;j++){-->
                        <!--tbody += '<td>';-->
                        <!--tbody +=  $u + ',' + ' '+ j + ' ' + ' ';-->
                        <!--tbody += '</td>';-->
                    <!--}-->
                <!--tbody += '</tr>\n';-->
            <!--}-->
            <!--var tfooter = '</table></div>';-->
            <!--document.getElementById('wrapper').innerHTML = document.getElementById('wrapper').innerHTML + theader + tbody + tfooter;-->
            <!--document.getElementById('headerID').innerHTML = name;-->

            <!--//Save box into schema-->
            <!--var boxCells = new Array;-->
            <!--var largerArray = new Array;-->
            <!--for (var i = 0; i < num_rows; i++)-->
            <!--{-->
                <!--boxCells = [];-->
                <!--for (var j=0; j < num_cols; j++){-->
<!--//                    alert(i);-->
                    <!--boxCells[j] = document.getElementById("newBox").rows[i].cells[j].innerHTML;-->
<!--//                    boxCells[j].innerHTML = boxCells[j].innerHTML + 'onclick = "changeCell.call(this)"';-->
<!--//                    alert(document.getElementById("newBox").rows[i].cells[j].innerHTML);-->
                <!--}-->
                <!--largerArray[i] = boxCells;-->
            <!--}-->

            <!--document.getElementById("newBox").id = name;-->
            <!--var obj = {"schema":"org.clothocad.model.Box","name":name, "containers":largerArray};-->
            <!--Clotho.get(personID).then(function (personObj) {-->
                <!--Clotho.create(obj).then(function (result) {-->
                    <!--personObj.containers[2] = result;-->
                    <!--Clotho.set(personObj);-->
                <!--});-->
            <!--});-->
        <!--});-->
    <!--});-->
<!--</script>-->


<script>
    function displaycontainers(){
        var personID = "clotho.developer.katielewis";
        Clotho.get(personID).then(function(personObj){
            var tableRef = document.getElementById("projTable");
            if (personObj.projects.length > 0) {
                var newRow = tableRef.insertRow(0);
                var newCell = newRow.insertCell(0);
                Clotho.get(personObj.projects[0]).then(function (proj) {
                    newCell.innerHTML = '<a href="./Projects.html" style = "display:block"+ value =' + proj.id + ' onclick = "projectDetails.call(this)">' + proj.name + '</a>';
                });
                for (var i = 1; i < personObj.projects.length; i++) {
                    Clotho.get(personObj.projects[i]).then(function (projectObj) {
                        newRow = tableRef.insertRow(tableRef.rows.length);
                        newCell = newRow.insertCell(0);
                        newCell.innerHTML = '<a href="./Projects.html" style = "display:block" value =' + projectObj.id + ' onclick = "projectDetails.call(this)">' + projectObj.name + '</a>';
                    });
                }
                }
            if(personObj.containers.length > 0){
                for (i=0; i< personObj.containers.length; i++){
                    Clotho.get(personObj.containers[i]).then(function(result){
                        document.getElementById("wrapper").innerHTML = document.getElementById("wrapper").innerHTML + JSON.stringify(result);
                    })
                }
            }
        });
    }
</script>
<script>
    function editBox(box){
        document.getElementById("hiddenParagraph").innerText = box.id;
        document.getElementById("changingBox").style.display = "block";
    }
</script>
<script>
    function changeCell(){
        var boxName = document.getElementById("hiddenParagraph").innerText;
        var box = document.getElementById(boxName);
        var boxCells = new Array;
        var largerArray = new Array;
        var num_rows = box.rows.length;
        var num_cols = box.rows[0].cells.length;
        var personID = "clotho.developer.katielewis";
        for (var i = 0; i < num_rows; i++)
        {
            boxCells = [];
            for (var j=0; j < num_cols; j++){
                boxCells[j] = box.rows[i].cells[j].innerHTML;
//                    boxCells[j].innerHTML = boxCells[j].innerHTML + 'onclick = "changeCell.call(this)"';
//                    alert(document.getElementById("newBox").rows[i].cells[j].innerHTML);
            }
            largerArray[i] = boxCells;
        }
//        var obj = {"schema":"org.clothocad.model.Box","name":boxName, "containers":largerArray};
        Clotho.get(personID).then(function (personObj) {
                if(personObj.containers.length > 0){
                    for (var i = 0; i < personObj.containers.length; i++){
                        Clotho.get(personObj.containers[i]).then(function(result1){
                            if(result1.name == boxName){
                                result1.containers = largerArray;
                                Clotho.set(result1);
                            }
                        })
                    }
                }
//                personObj.containers[0] = result;
//                alert(result);
//                alert(personObj.containers[0]);
//                Clotho.set(personObj);
            });
        document.getElementById("changingBox").style.display = "none";
        document.getElementById("hiddenParagraph").innerText = "";
    }
</script>

<script src="scripts/LabOrdering-app.js"></script>
<script src="scripts/Ordering.js"></script>
<script src="scripts/Tracking.js"></script>
<script src="scripts/orderingCtrl.js"></script>


</body>
</html>