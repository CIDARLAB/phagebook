<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Projects</title>
    <meta name="description" content="Clotho Projects">
    <meta name="viewport" content="width=1024, initial-scale=1">
      <script src ="clotho3API/clotho3API.js"></script>

    <!-- not necessary until serving outside root directory / want html5 mode -->
    <base href="/">

    <link rel="stylesheet" href="styles/2e84f2a0.command.css"/>
    <link rel="stylesheet" href="styles/773cbfe6.main.css"/>
    <link rel ="stylesheet" href="styles/Phagebook_Styles.css"/>

    <script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/q.js/1.0.0/q.js"></script>
    <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>

    <script src="bower_components/jquery/jquery.js"></script>

    <!-- note that angular is required for any clotho functionality -->
    <script src="bower_components/angular/angular.js"></script>
    <!-- note that lodash is required by several components -->
    <script src="bower_components/lodash/dist/lodash.js"></script>
      <script src="projectsCTRL.js"></script>
    <script src="projects-app.js"></script>

</head>
<body ng-controller = "projectsCTRL" onload = "displayProjects()">
<!--[if lt IE 9]>
<script src="bower_components/es5-shim/es5-shim.js"></script>
<script src="bower_components/json3/lib/json3.min.js"></script>
<![endif]-->

<div ng-app="clothoRoot">
  <div class="container">
    <div clotho-command-bar></div>
  </div>

  <terminal-aside></terminal-aside>


<div class = "contentBackground" ng-app = "projects">
    <div class = "mainContent">
        <div class = "leftColumn">
          <img src = "/images/people/Katie_Lewis.jpeg">
          <h4> <a href ="./Profile.html">Katie Lewis</a> Projects </h4>
            <table id="projTable">
                <!--<tr>-->
                    <!--<td id="iGEM"><a href="./Projects.html" value="igem.id" style="display:block;">iGEM</a> </td>-->
                <!--</tr>-->
                <!--<tr>-->
                    <!--<td id="Phagebook"><a href = "./Projects.html" style = "display:block;">Phagebook</a></td>-->
                <!--</tr>-->
            </table>

          <br><br>

          <button type="button" id="CreateButton">Create New Project </button>

        </div>

        <div id = "rightColumn">
          <button>  <img src = "/images/Editing-Edit-icon.png" onclick = "editProject()" id="editIcon"></button>
            <h1 class = "pageHeading" id = "projTitle"> </h1>
          <div class = "information">
            <ul class = "labInfo"> 
              <li> Associated Labs: </li>
              <li> Primary Investigator: </li>
              <li> Project Lead: </li>
              <li> Project Advisor </li>
                <li> Description: </li>
            </ul>

            <ul class = "labInfo2"> 
              <li id="currentLab">  </li>
              <li id="currentPI">  </li>
              <li id="currentLead">  </li>
              <li id="currentAdvisor"> </li>
            </ul>
            </div>
            <p id = "projectDescription" ></p>
                <!--<p>  Currently, synthetic biology lacks a systematic design-build-test workflow for creating genetic circuits. Researchers often waste time and resources on traditional trial-and-error approaches in designing and assembling large devices. My research works towards overcoming this roadblock by creating a standardized experimental-computational workflow that is clearly defined and applicable to a wide variety of researchers and projects. This workflow integrates software tools to reduce human error and to structure the way designs are chosen, assembled, and tested.-->
            <!--</p>-->

          <div class = "notebook">
            <ul class = "labnotebook">  <li>Notebook </li> </ul>
              <button onclick = "newEntry()" id = "newEntry" >New Entry</button><br>
              <form action ="" class = "dropDown">
              <select name = "notebook" onchange = "notebook_projects(this.value)" id="whosNotebook">
                <option value = "Katie Lewis">Katie Lewis</option>
                <option value = "Yash Agarwal">Yash Agarwal </option>
                <option value = "Alan Pacheco">Alan Pacheco </option>
              </select>
            </form>
              <!--<input type="button" id="uploader" value="Upload">-->

              <p class = "notebookText" id = "notebookID">
            </p>

          </div>
        </div>



<div id="createProject">
    <ng-form class="form-horizontal" name="projectForm" ng-class="{'has-error' : projectForm.name.$dirty && projectForm.name.$invalid}">

        <h1 class = "pageHeading"> Create New Project </h1><br><br> 
        <label>Project Name: </label> <br> 
        <input id="projName" type="text"><br><br> 
        <label>Lab(s):</label><br>
        <input id="projLabs" type="text"><br><br>
        <label> PI:</label><br> 
        <input id="pi" type="text"><br><br> 
        <label>Project Lead:</label><br>
        <input id="projLead" type="text"><br><br>
        <label>Project Advisor:</label><br>
        <input id="advisor" type="text"><br><br>
        <label>Parts Used</label>
        <!--<label>Project Members:</label>-->
        <!--<input id="projMembers" type="text"><br><br>-->
        <label>Project Description:</label> 
        <textarea id="description" rows="7" cols="50"> </textarea><br><br> 
        <button id = "create" class="btn btn-primary" >Create</button><br>


    </ng-form>
</div>
    <div id="notebookEntry">
        <ng-form class="form-horizontal" id="notebookEn" ng-class="{'has-error' : projectForm.name.$dirty && projectForm.name.$invalid}">
            <h1 class = "pageHeading"> New Lab Notebook Entry </h1><br><br> 
            <label>Date (d/m/y): </label><br><br>
            <input id="entryDate" type="date"><br><br>
            <label>Images: </label>
            <input type="file" id = "entryPic" name="filename" accept="image/gif, image/jpeg, image/png">
            <input type="file" id = "entryPic1" name="filename" accept="image/gif, image/jpeg, image/png">
            <input type="file" id = "entryPic2" name="filename" accept="image/gif, image/jpeg, image/png">


        </ng-form>
        <p id="entryText">Notebook Entry:</p>
        <textarea rows="4"; cols="50"; id="textEntry"></textarea><br>
        <!--<form action="scripts/newProject/uploadFile.php" method="post" id="uploader" enctype="multipart/form-data">-->
            <!--Select image to upload:-->
            <!--<input type="file" name="fileToUpload" id="fileToUpload">-->
            <!--<input type="submit" value="Upload Image" name="submit">-->
        <!--</form>-->
        <button id="entryButton" onclick = "createEntry()">Create</button>

    </div>
</div>
    </div>



  <!--------
SCRIPTS
--------->

<!--note - correct app based on the distribution, comments removed by build-->

<!--<script type="text/javascript">-->
  <!--document.getElementById("Create").onclick = function(){-->
    <!--location.href = "./createProject.html";-->
  <!--}-->
<!--</script>-->
    <script src="scripts/b18fc8c8.clotho-app-command.js"></script>

    <script src="scripts/c0f113c2.clotho-core-module.js"></script>

    <!--<script src ="scripts/notebook_projects.js"></script>-->

    <!--note - remove all scripts below this for api-only build-->

    <script src="scripts/c2a11f43.clotho-foundation-module.js"></script>


    <script src="scripts/68a2b2df.clotho-command-module.js"></script>

<script type = "text/javascript">
    $(document).ready(function(){
        $("#CreateButton").click(function(){
            var id = document.getElementById("rightColumn");
            var secondID = document.getElementById("createProject");
            var thirdID = document.getElementById("notebookEntry");
            thirdID.style.display = 'none';
            id.style.display='none';
            secondID.style.display = 'block';
        });
    });
</script>

    <script>
        //How should I get the project ID for the project that the entry is in
        function createEntry(){
            var personID = "clotho.developer.katielewis1";
            var str = '{';
            var obj = str.concat('"schema":', '"org.clothocad.model.Notebook"',',"entryDate":','"',document.getElementById("entryDate").value, '"', ',"entryText":', '"', document.getElementById("textEntry").value, '"', ',"entryPics":[', '"', document.getElementById("entryPic").value,'",', '"', document.getElementById("entryPic1").value, '",', '"', document.getElementById("entryPic2").value, '"]', '}');
            var jsonObj = JSON.parse(obj);
            Clotho.get(personID).then(function (personObj) {
                Clotho.create(jsonObj).then(function (result) {
                    personObj.notebookEntries[personObj.notebookEntries.length] = result;
                    Clotho.set(personObj);
            });
            });
            var id = document.getElementById("rightColumn");
            var secondID = document.getElementById("createProject");
            var thirdID = document.getElementById("notebookEntry");
            id.style.display = 'block';
            secondID.style.display = 'none';
            thirdID.style.display = 'none';
        };
    </script>

<script>
    function editProject(){

    };
</script>

    <script>
        function newEntry(){
            var id = document.getElementById("rightColumn");
            var secondID = document.getElementById("notebookEntry");
            var thirdID = document.getElementById("createProject");
            thirdID.style.display = 'none';
            id.style.display = 'none';
            secondID.style.display = 'block';
        };
    </script>

<script>
   function displayProjects() {
       var personID = "clotho.developer.katielewis1";
       Clotho.get(personID).then(function (personObj) {
           var tableRef = document.getElementById("projTable");
           if (personObj.projects.length > 0) {
               var newRow = tableRef.insertRow(0);
               var newCell = newRow.insertCell(0);
               Clotho.get(personObj.projects[0]).then(function (proj) {
                   newCell.innerHTML = '<a href="./Projects.html" style = "display:block"+ value =' + proj.id + ' onclick = "projectDetails.call(this)">' + proj.name + '</a>';
               });
               for (var i = 1; i < personObj.projects.length; i++) {
                   Clotho.get(personObj.projects[i]).then(function (projectObj) {
                       newRow = tableRef.insertRow(tableRef.rows.length);
                       newCell = newRow.insertCell(0);
                       newCell.innerHTML = '<a href="./Projects.html" style = "display:block" value =' + projectObj.id + ' onclick = "projectDetails.call(this)">' + projectObj.name + '</a>';
                   });

               }
//                if(personObj.notebookEntries.length > 0){
//                    for(var i = 0; i < personObj.notebookEntries.length;i++){
//                        document.getElementById("notebookText").innerHTML += personObj.notebookEntries[i];
//                    }
//                }

               Clotho.get(personObj.projects[0]).then(function (projObj) {
                   document.getElementById("projTitle").innerHTML = projObj.name;
                   document.getElementById("currentLab").innerHTML = projObj.Lab;
                   document.getElementById("currentLead").innerHTML = projObj.projectLead;
                   document.getElementById("currentPI").innerHTML = projObj.PI;
                   document.getElementById("currentAdvisor").innerHTML = projObj.advisor;
                   document.getElementById("projectDescription").innerHTML = projObj.Description;
               });
           }
           else if(personObj.projects.length == 0){
               var id = document.getElementById("rightColumn");
               var secondID = document.getElementById("createProject");
               var thirdID = document.getElementById("notebookEntry");
               thirdID.style.display = 'none';
               id.style.display='none';
               secondID.style.display = 'block';
           }


       });
   };
</script>

    <script>
       function projectDetails(){
           var personID  = "clotho.developer.katielewis1";
           var projName = this.innerText;
//           var val = this.id;
           var id = document.getElementById("rightColumn");
           var secondID = document.getElementById("createProject");
           var thirdID = document.getElementById("notebookEntry");
           id.style.display = 'block';
           secondID.style.display = 'none';
           thirdID.style.display = 'none';
           Clotho.get(personID).then(function(Obj){
               var num = 4;
               alert(projName);
               for (var i = 0; i< Obj.projects.length;i++)
               {
                   Clotho.get(Obj.projects[i]).then(function(projObj){
                       if (projObj.name.toLowerCase() == projName.toLowerCase()){
                           num = i;
                       };
                       alert(i);
                   });
               };
               Clotho.get(Obj.projects[num]).then(function(correctProj){
                   document.getElementById("projTitle").innerHTML =correctProj.name;
                   document.getElementById("currentLab").innerHTML = correctProj.Lab;
                   document.getElementById("currentLead").innerHTML = correctProj.projectLead;
                   document.getElementById("currentPI").innerHTML = correctProj.PI;
                   document.getElementById("currentAdvisor").innerHTML = correctProj.advisor;
                   document.getElementById("projectDescription").innerHTML = correctProj.Description;

               });

           });
       };
    </script>
<script>
    $("input").change(function(e) {
    for (var i = 0; i < e.originalEvent.srcElement.files.length; i++) {
    var file = e.originalEvent.srcElement.files[i];
    var img = document.createElement("img");
    var reader = new FileReader();
    reader.onloadend = function() {
    img.src = reader.result;
    }
    reader.readAsDataURL(file);
    $("input").after(img);
    }
    });
</script>


    <!--$(document).ready(function() {-->
    <script>
    var personID = "clotho.developer.katielewis1";
    $(document).ready(function() {
        $("#create").click(function () {
            var str = '{';
            var firstObj = str.concat('"schema":', '"org.clothocad.model.Projects"', ',"name":', '"', document.getElementById("projName").value, '"', ',"projectLead":', '"', document.getElementById("projLead").value, '"');
            var obj = firstObj.concat(',"Lab":', '"', document.getElementById("projLabs").value, '"', ',"PI":', '"', document.getElementById("pi").value, '"', ',"Description":', '"', document.getElementById("description").value, '"', ',"advisor":', '"', document.getElementById("advisor").value, '"', '}');
            //            alert(obj);
            var jsonObj = JSON.parse(obj);
            Clotho.create(jsonObj).then(function (result) {
                Clotho.get(personID).then(function (personObj) {
//                    alert(JSON.stringify(personObj.projects));
                    personObj.projects[personObj.projects.length] = result;
                    Clotho.set(personObj).then(function () {
//                        alert(ID);

//                        document.getElementById("projTitle").innerHTML = personObj.projects[personObj.projects.length - 1].name;
//                        document.getElementById("currentLab").innerHTML = personObj.projects[personObj.projects.length - 1].Lab;
//                        document.getElementById("currentLead").innerHTML = personObj.projects[personObj.projects.length - 1].projectLead;
//                        document.getElementById("currentPI").innerHTML = personObj.projects[personObj.projects.length - 1].PI;
//                        document.getElementById("currentAdvisor").innerHTML = personObj.projects[personObj.projects.length - 1].advisor;
                        Clotho.get(personObj.projects[personObj.projects.length -1]).then(function(projectObj){
                            var tableRef = document.getElementById("projTable");
                            var newRow = tableRef.insertRow(tableRef.rows.length);
                            var newCell = newRow.insertCell(0);
                            newCell.innerHTML = '<a href="./Projects.html" style = "display:block" id="' + projectObj.id + '" onclick = "projectDetails.call(this)">' + projectObj.name + '</a>';
                            alert(projectObj.id);
                            alert(newCell.id);
                            var id = document.getElementById("rightColumn");
                            var secondID = document.getElementById("createProject");
                            id.style.display = 'block';
                            secondID.style.display = 'none';
                            document.getElementById("projTitle").innerHTML = projectObj.name;
                            document.getElementById("currentLab").innerHTML = projectObj.Lab;
                            document.getElementById("currentLead").innerHTML = projectObj.projectLead;
                            document.getElementById("currentPI").innerHTML = projectObj.PI;
                            document.getElementById("currentAdvisor").innerHTML = projectObj.advisor;

                        });




                    });
                });

            });
        });
    });
    </script>

    <!--<script type="text/javascript">-->

        <!--var uploader = document.getElementById('uploader');-->

        <!--upclick(-->
                <!--{-->
                    <!--element: uploader,-->
                    <!--action: '/path_to/you_server_script.php',-->
                    <!--onstart:-->
                            <!--function(filename)-->
                            <!--{-->
                                <!--alert('Start upload: '+filename);-->
                            <!--},-->
                    <!--oncomplete:-->
                            <!--function(response_data)-->
                            <!--{-->
                                <!--alert(response_data);-->
                            <!--}-->
                <!--});-->





<!-- our custom app files -->
<script src="scripts/LabOrdering-app.js"></script>
<script src="scripts/Ordering.js"></script>
<script src="scripts/Tracking.js"></script>
<script src="scripts/orderingCtrl.js"></script>


</body>
</html>
