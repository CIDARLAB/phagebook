<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Profile</title>
    <meta name="description" content="Clotho Lab Ordering">
    <meta name="viewport" content="width=1024, initial-scale=1">

    <!-- not necessary until serving outside root directory / want html5 mode -->
    <base href="/">

    <link rel="stylesheet" href="styles/2e84f2a0.command.css"/>
    <link rel="stylesheet" href="styles/773cbfe6.main.css"/>


    <script src="bower_components/jquery/jquery.js"></script>

    <!-- note that angular is required for any clotho functionality -->
    <script src="bower_components/angular/angular.js"></script>
    <!-- note that lodash is required by several components -->
    <script src="bower_components/lodash/dist/lodash.js"></script>

    <script src= "https://ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular.min.js"></script>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/q.js/1.0.0/q.js"></script>

    <style>
        #profileName
        {
            color: white;
            text-shadow:
            -1px -1px 0 #000,
            1px -1px 0 #000,
            -1px 1px 0 #000,
            1px 1px 0 #000;
        }
    </style>

</head>
<body>
<div ng-app="clothoRoot">
    <div class="container">
        <div clotho-command-bar></div>
    </div>

    <terminal-aside></terminal-aside>
</div>
<div class="contentBackground" style="margin-left:-10px; margin-right:-10px; margin-top:-20px; margin-bottom:-100px; background-color:#e9eaed">
    <div class="mainContent" style="width:851px;  margin-left:auto; margin-right:auto; background-color:#fff; font-family:helvetica">
        <div class="coverContainer" style="background-image:url(/images/logo-CIDAR-2.png); background-repeat: no-repeat;">
            <div class="row">
                <div class="col-xs-9 col-xs-offset-2" style="margin-top:245px;">
                    <h3> <strong> <p id  = "profileName" ></p></strong>
                    </h3>
                </div>
            </div>
            <div class="row">
                <div class="col-xs-2" style="margin-left:16px;">
                  <!--  <img id = "profilePicture">-->
                    <img src = /images/people/kara_pro.PNG style="margin-top:-130px; padding:3px; background-color:#fff; border:1px solid #000;">

                </div>
                <div class="col-xs-9" style="margin-top:40px;" >
                    <h4>
                        <a href="./Profile.html" class="col-xs-2">News</a>
                        <a href="./Ordering.html" class="col-xs-2">Ordering</a>
                        <a href="./Profile_papers.html" class="col-xs-2">Papers</a>
                        <a href="./Projects.html" class="col-xs-2">Projects</a>
                        <a href="" class="col-xs-2">Parts</a> <br>


                    </h4>
                </div>
            </div>

            <div class="personalNews">
                <div class="row">
                    <div class="col-xs-2" style="margin-left:90px; margin-bottom:16px;">
                        <!--<body id = "papersDisplay" >
                        </body>-->
                        <br>
                        <br>
                       <!-- <div class="col-xs-2" style="margin-left:44px; margin-bottom:16px; text-decoration: underline;">
                            <h2>Papers</h2>-->
                        </div>

                        <table id="keyValueForm" class="form-inline " style='margin-bottom: 10px;width:700px' role="form">
                            <tbody style="text-align: center;">

                        </table>

                        <button  class="btn btn-primary" id = "addButton" style='margin-left: 40px' > + </button>
                        </p>
                        <div class = "container">

                        </div>
                        <br>
                        <br>

                        <br>
                        <br>
                        <div id = "theInputs">
                            <table>
                                <label> <strong> PUBMEDID </strong></label>
                                <input id = "pubmedid" name = "pubmedid" style = "width: 400px;"> <br>
                                <label> <strong> Author(s) </strong> </label>
                                <input  id = "author" name = "author" style="width: 400px;"><br>
                                <label> <strong> Title</strong> </label>
                                <input id="title" name="title" style="width: 200px;">
                                <label> <strong> Name</strong> </label>
                                <input id="name" name="name" style="width: 200px;"><br>
                                <label> <strong> Link</strong> </label>
                                <input id="link" name="link" style="width: 200px;">
                                <label> <strong> Conference </strong> </label>
                                <input id="conference" name="conference" style="width: 200px;">
                                <br>
                                <label><strong> Journal </strong></label>
                                <input id="journal" name="journal" >

                                <label><strong> Volume </strong></label>
                                <input id="volume" name="volume"style="width: 40px;"><br>
                                <label><strong> Book </strong></label>
                                <input id="book" name="book" ><br>
                                <label><strong> Year </strong></label>
                                <input list="year" name="year">
                                <!--maybe add a calendar box instead of separate inputs -->
                                <datalist id = "year">
                                    <option value  = "2015" >2015</option>
                                    <option value  = "2014" >2014</option>
                                    <option value  = "2013" >2013</option>
                                    <option value  = "2012" >2012</option>
                                    <option value  = "2011" >2011</option>
                                    <option value  = "2010" >2010</option> </datalist>
                                <label> <strong> Month </strong></label>
                                <input list="month" name="month">
                                <datalist id = "month">
                                    <option value  = "January" >January</option>
                                    <option value  = "February" >February</option>
                                    <option value  = "March" >March</option>
                                    <option value  = "April" >April</option>
                                    <option value  = "May" >May</option>
                                    <option value  = "June" >June</option>
                                    <option value  = "July" >July</option>
                                    <option value  = "August" >August</option>
                                    <option value  = "September" >September</option>
                                    <option value  = "October" >October</option>
                                    <option value  = "November" >November</option>
                                    <option value  = "December" >December</option>
                                </datalist>
                                <label><strong> Day </strong></label>
                                <input id="daybox" name="day"style="width: 40px;"><br>
                                <label><strong> Pages </strong></label>
                                <input id="pagesbox" name="pages" style="width: 40px;" > <br>

                                <p>
                                    <button class="btn btn-primary" id = "addPaper" >Add Paper</button>
                                </p>
                            </table>
                            <p>

                            </p>


                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>



<!--------
SCRIPTS
--------->

<!--note - correct app based on the distribution, comments removed by build-->

<script>
    // get login



</script>




<script>

    $("#addButton").click(function(){
        //  alert("addButton Clicked")
        document.getElementById("theInputs").style.visibility = "visible";
    });

</script>


<script>
    var personID = "clotho.developer.klefort";
    document.getElementById("theInputs").style.visibility = "hidden";
    $("#addPaper").click(function() {
        //alert("button clicked")
        var obj = [ ];
        var myInput = document.getElementsByTagName("input");

        for(var i = 0; i< myInput.length; i++)
        {
            obj.push('\"'+ myInput[i].name + '\": \"'+ myInput[i].value + '\"')

        }
        //alert(obj)
       // var paperObj  = '{'+ obj +'}';
 var paperObj = '{' + obj + "schema" : "org.clothocad.model.Papers" +'}';
        alert(paperObj);

        Clotho.create(JSON.parse(paperObj)).then(function(result){
            //alert(JSON.stringify(result));
            Clotho.get(personID).then(function(personObj) {
               // personObj.papers = personObj.papers.push(result);
               // personObj.papers[personObj.papers.length]= result
              //alert(result.id)
                //alert(result)
                alert(JSON.stringify(result))
                //alert(JSON.stringify(personObj.papers))
               // alert(result)
                //alert(JSON.stringify(result))
                personObj.papers.push(result)
                //alert(personObj.papers)
                //alert(personObj.papers + JSON.parse(result))
                //personObj.papers = personObj.papers + JSON.parse(result)

               // alert(personObj.papers)
               Clotho.set(personObj)


            })
        });
    });
</script>




<script>
    $(document).ready(function() {
        {
//var check = "4309"
  //          alert("<td> <a href = 'http://www.ncbi.nlm.nih.gov/pubmed/"+check +"'>PUBMEDID</a>")
            var personID = "clotho.developer.klefort";
            var notNullArray = [];
            Clotho.get(personID).then(function (personObj) {

                document.getElementById("profileName").innerHTML = personObj.name;
       // document.getElementById("profilePicture").innerHTML = 'src=\"/images/people/'+ personObj.picture + '\" style=\"margin-top:-130px; padding:3px; background-color:#fff; border:1px solid #000;\">'
                Clotho.get(personObj.papers).then(function (paperObj) {
                    //alert(paperObj.length)

                    if (paperObj.length == null)// when there is only paper the parObj changes from
                    {

                        var paperCite1 = '';

                        paperCite1 = paperCite1.concat(paperObj.title, paperObj.author, paperObj.journal);
                        $('#keyValueForm').append("<tr style='margin-top: 10px; width:400px '> <td> <div  style='margin-bottom: 10px;'>" +
                        "<p>" + paperCite1 + "</p></div> </td>" + "<td> <a href = '> PUBMEDID </a> </td>"+  "<td> <button onclick= 'deletePaper(" + JSON.stringify(paperObj) + ")' class='btn btn-primary'" + " >x</button >" +
                        "</td>" + "</tr>")
                    }
                    else {
                        for (var i = 0; i < paperObj.length; i++) {
                            // alert("here")
                            if (paperObj[i] == null) {

                                personObj.papers[i] = [];
                            }
                            else {
            //alert(paperObj[i].pubmedid)
                                notNullArray.push(i);

                                var paperCite = '';
                                var myObj = paperObj[i];
                               // alert(myObj)
                               // alert(JSON.stringify(paperObj[i]))
                                paperCite = paperCite.concat(paperObj[i].title, paperObj[i].author, paperObj[i].journal);
                                $('#keyValueForm').append("<tr style='margin-top: 10px;'> <td> <div  style='margin-bottom: 10px;'>" +
                                "<p>" + paperCite + "</p></div> </td>" + "<td> <a href = 'http://www.ncbi.nlm.nih.gov/pubmed/" + paperObj[i].pubmedid + "'> PUBMEDID </a> </td>"+ "<td> <button onclick= 'deletePaper(" + JSON.stringify(myObj) + ")' class='btn btn-primary'" + " >x</button >" +
                                "</td>" + "</tr>");
                            }
                        }
                    }

                })
                Clotho.set(personObj);
               /* Clotho.get(personID).then(function (personObj) {

                    //alert(JSON.stringify(personObj.papers));
                    personObj.papers = [personObj.papers[notNullArray]];
                    Clotho.set(personObj)
                })*/
            });
        }
    })
</script>


<script>
    function deletePaper(myObj){

        Clotho.destroy(myObj.id)

    };


</script>



<script src="scripts/b18fc8c8.clotho-app-command.js"></script>

<script src="scripts/c0f113c2.clotho-core-module.js"></script>



<!--note - remove all scripts below this for api-only build-->

<script src="scripts/c2a11f43.clotho-foundation-module.js"></script>
<script src="scripts/68a2b2df.clotho-command-module.js"></script>

<!-- our custom app files -->
<script src="scripts/LabOrdering-app.js"></script>
<script src="scripts/Ordering.js"></script>
<script src="scripts/Tracking.js"></script>
<script src="scripts/orderingCtrl.js"></script>
<script src="scripts/clotho3API.js"></script>
<script src = "scripts/addPaper.js"></script>


</body>
<!--
 {"id":"clotho.developer.katielewis1","name":"Katie Lewis","schema":"org.clothocad.model.PersonalProfile","institution":"Boston University","lab":"CIDAR","position":"Undergraduate","permission":"basic", "username":"kmlewis","projects":[{"schema":"org.clothocad.model.Projects","name":"iGEM","projectLead":"Traci Haddock","Lab":"CIDAR","PI":"Doug Densmore","description":"This is a cool project","advisor":"Evan Appleton"}],"orders":[], "papers":[]}


{"institution":"Boston University","lab":"CIDAR","name":"Kara Le Fort","orders":[],"papers":[],"permission":"basic","position":"Undergraduate","projects":[{"schema":"org.clothocad.model.Projects","name":"iGEM","projectLead":"Prashant","Lab":"CIDAR","PI":"Doug Densmore",,"advisor":"Prashant V"}],"schema":"org.clothocad.model.PersonalProfile","username":"klefort","id":"clotho.developer.karalefort"}

-->
</html>
